import{c as G,o as Q,r as ge,a as y,g as pe,b as Y,i as Z,u as N,d as ee,e as me,f as te,h as we,j as V,k as p,l as ve,S as ne,m as Re,n as ye,s as Pe,p as C,q as be,t as S,v as X,w as $e,x as A}from"./chunks/web.33a095e2.js";function Se(e,t,r){return e.addEventListener(t,r),()=>e.removeEventListener(t,r)}function _e([e,t],r,n){return[r?()=>r(e()):e,n?o=>t(n(o)):t]}function xe(e){try{return document.querySelector(e)}catch{return null}}function Ce(e,t){const r=xe(`#${e}`);r?r.scrollIntoView():t&&window.scrollTo(0,0)}function Ae(e,t,r,n){let o=!1;const s=c=>typeof c=="string"?{value:c}:c,a=_e(G(s(e()),{equals:(c,l)=>c.value===l.value}),void 0,c=>(!o&&t(c),c));return r&&Q(r((c=e())=>{o=!0,a[1](s(c)),o=!1})),{signal:a,utils:n}}function Ee(e){if(e){if(Array.isArray(e))return{signal:e}}else return{signal:G({value:""})};return e}function Le(e){return{signal:[()=>e,t=>Object.assign(e,t)]}}function Oe(){return Ae(()=>({value:window.location.pathname+window.location.search+window.location.hash,state:history.state}),({value:e,replace:t,scroll:r,state:n})=>{t?window.history.replaceState(n,"",e):window.history.pushState(n,"",e),Ce(window.location.hash.slice(1),r)},e=>Se(window,"popstate",()=>e()),{go:e=>window.history.go(e)})}const Te=/^(?:[a-z0-9]+:)?\/\//i,je=/^\/+|\/+$/g;function I(e,t=!1){const r=e.replace(je,"");return r?t||/^[?#]/.test(r)?r:"/"+r:""}function B(e,t,r){if(Te.test(t))return;const n=I(e),o=r&&I(r);let s="";return!o||t.startsWith("/")?s=n:o.toLowerCase().indexOf(n.toLowerCase())!==0?s=n+o:s=o,(s||"/")+I(t,!s)}function Ie(e,t){if(e==null)throw new Error(t);return e}function re(e,t){return I(e).replace(/\/*(\*.*)?$/g,"")+I(t)}function ke(e){const t={};return e.searchParams.forEach((r,n)=>{t[n]=r}),t}function x(e,t){return decodeURIComponent(t?e.replace(/\+/g," "):e)}function Ue(e,t){const[r,n]=e.split("/*",2),o=r.split("/").filter(Boolean),s=o.length;return a=>{const c=a.split("/").filter(Boolean),l=c.length-s;if(l<0||l>0&&n===void 0&&!t)return null;const i={path:s?"":"/",params:{}};for(let u=0;u<s;u++){const h=o[u],m=c[u];if(h[0]===":")i.params[h.slice(1)]=m;else if(h.localeCompare(m,void 0,{sensitivity:"base"})!==0)return null;i.path+=`/${m}`}return n&&(i.params[n]=l?c.slice(-l).join("/"):""),i}}function qe(e){const[t,r]=e.pattern.split("/*",2),n=t.split("/").filter(Boolean);return n.reduce((o,s)=>o+(s.startsWith(":")?2:3),n.length-(r===void 0?0:1))}function oe(e){const t=new Map,r=pe();return new Proxy({},{get(n,o){return t.has(o)||ge(r,()=>t.set(o,y(()=>e()[o]))),t.get(o)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(e())}})}function se(e){let t=/(\/?\:[^\/]+)\?/.exec(e);if(!t)return[e];let r=e.slice(0,t.index),n=e.slice(t.index+t[0].length);const o=[r,r+=t[1]];for(;t=/^(\/\:[^\/]+)\?/.exec(n);)o.push(r+=t[1]),n=n.slice(t[0].length);return se(n).reduce((s,a)=>[...s,...o.map(c=>c+a)],[])}const Be=100,ae=Y(),K=Y(),W=()=>Ie(N(ae),"Make sure your app is wrapped in a <Router />");let k;const z=()=>k||N(K)||W().base,Ge=e=>{const t=z();return y(()=>t.resolvePath(e()))},Ke=e=>{const t=W();return y(()=>{const r=e();return r!==void 0?t.renderPath(r):r})};function He(e,t="",r){const{component:n,data:o,children:s}=e,a=!s||Array.isArray(s)&&!s.length,c={key:e,element:n?()=>p(n,{}):()=>{const{element:l}=e;return l===void 0&&r?p(r,{}):l},preload:e.component?n.preload:e.preload,data:o};return ie(e.path).reduce((l,i)=>{for(const u of se(i)){const h=re(t,u),m=a?h:h.split("/*",1)[0];l.push({...c,originalPath:u,pattern:m,matcher:Ue(m,!a)})}return l},[])}function Ne(e,t=0){return{routes:e,score:qe(e[e.length-1])*1e4-t,matcher(r){const n=[];for(let o=e.length-1;o>=0;o--){const s=e[o],a=s.matcher(r);if(!a)return null;n.unshift({...a,route:s})}return n}}}function ie(e){return Array.isArray(e)?e:[e]}function ce(e,t="",r,n=[],o=[]){const s=ie(e);for(let a=0,c=s.length;a<c;a++){const l=s[a];if(l&&typeof l=="object"&&l.hasOwnProperty("path")){const i=He(l,t,r);for(const u of i){if(n.push(u),l.children)ce(l.children,u.pattern,r,n,o);else{const h=Ne([...n],o.length);o.push(h)}n.pop()}}}return n.length?o:o.sort((a,c)=>c.score-a.score)}function We(e,t){for(let r=0,n=e.length;r<n;r++){const o=e[r].matcher(t);if(o)return o}return[]}function ze(e,t){const r=new URL("http://sar"),n=y(l=>{const i=e();try{return new URL(i,r)}catch{return console.error(`Invalid path ${i}`),l}},r,{equals:(l,i)=>l.href===i.href}),o=y(()=>x(n().pathname)),s=y(()=>x(n().search,!0)),a=y(()=>x(n().hash)),c=y(()=>"");return{get pathname(){return o()},get search(){return s()},get hash(){return a()},get state(){return t()},get key(){return c()},query:oe(te(s,()=>ke(n())))}}function Fe(e,t="",r,n){const{signal:[o,s],utils:a={}}=Ee(e),c=a.parsePath||(d=>d),l=a.renderPath||(d=>d),i=B("",t),u=Z&&n?Object.assign(n,{matches:[],url:void 0}):void 0;if(i===void 0)throw new Error(`${i} is not a valid base path`);i&&!o().value&&s({value:i,replace:!0,scroll:!1});const[h,m]=we(),[w,f]=G(o().value),[E,L]=G(o().state),U=ze(w,E),P=[],_={pattern:i,params:{},path:()=>i,outlet:()=>null,resolvePath(d){return B(i,d)}};if(r)try{k=_,_.data=r({data:void 0,params:{},location:U,navigate:M(_)})}finally{k=void 0}function F(d,g,v){V(()=>{if(typeof g=="number"){g&&(a.go?a.go(g):console.warn("Router integration does not support relative routing"));return}const{replace:R,resolve:O,scroll:T,state:q}={replace:!1,resolve:!0,scroll:!0,...v},b=O?d.resolvePath(g):B("",g);if(b===void 0)throw new Error(`Path '${g}' is not a routable path`);if(P.length>=Be)throw new Error("Too many redirects");const $=w();if(b!==$||q!==E()){const j=P.push({value:$,replace:R,scroll:T,state:E()});m(()=>{f(b),L(q)}).then(()=>{P.length===j&&fe({value:b,state:q})})}})}function M(d){return d=d||N(K)||_,(g,v)=>F(d,g,v)}function fe(d){const g=P[0];g&&((d.value!==g.value||d.state!==g.state)&&s({...d,replace:g.replace,scroll:g.scroll}),P.length=0)}ee(()=>{const{value:d,state:g}=o();V(()=>{d!==w()&&m(()=>{f(d),L(g)})})});{let d=function(v){return v.namespaceURI==="http://www.w3.org/2000/svg"},g=function(v){if(v.defaultPrevented||v.button!==0||v.metaKey||v.altKey||v.ctrlKey||v.shiftKey)return;const R=v.composedPath().find(J=>J instanceof Node&&J.nodeName.toUpperCase()==="A");if(!R)return;const O=d(R),T=O?R.href.baseVal:R.href;if((O?R.target.baseVal:R.target)||!T&&!R.hasAttribute("state"))return;const b=(R.getAttribute("rel")||"").split(/\s+/);if(R.hasAttribute("download")||b&&b.includes("external"))return;const $=O?new URL(T,document.baseURI):new URL(T),j=x($.pathname);if($.origin!==window.location.origin||i&&j&&!j.toLowerCase().startsWith(i.toLowerCase()))return;const de=c(j+x($.search,!0)+x($.hash)),D=R.getAttribute("state");v.preventDefault(),F(_,de,{resolve:!1,replace:R.hasAttribute("replace"),scroll:!R.hasAttribute("noscroll"),state:D&&JSON.parse(D)})};me(["click"]),document.addEventListener("click",g),Q(()=>document.removeEventListener("click",g))}return{base:_,out:u,location:U,isRouting:h,renderPath:l,parsePath:c,navigatorFactory:M}}function Me(e,t,r,n){const{base:o,location:s,navigatorFactory:a}=e,{pattern:c,element:l,preload:i,data:u}=n().route,h=y(()=>n().path),m=oe(()=>n().params);i&&i();const w={parent:t,pattern:c,get child(){return r()},path:h,params:m,data:t.data,outlet:l,resolvePath(f){return B(o.path(),f,h())}};if(u)try{k=w,w.data=u({data:t.data,params:m,location:s,navigate:a(w)})}finally{k=void 0}return w}const De=A("<a></a>"),Je=e=>{const{source:t,url:r,base:n,data:o,out:s}=e,a=t||(Z?Le({value:r||""}):Oe()),c=Fe(a,n,o,s);return p(ae.Provider,{value:c,get children(){return e.children}})},Ve=e=>{const t=W(),r=z(),n=ve(()=>e.children),o=y(()=>ce(n(),re(r.pattern,e.base||""),Qe)),s=y(()=>We(o(),t.location.pathname));t.out&&t.out.matches.push(s().map(({route:i,path:u,params:h})=>({originalPath:i.originalPath,pattern:i.pattern,path:u,params:h})));const a=[];let c;const l=y(te(s,(i,u,h)=>{let m=u&&i.length===u.length;const w=[];for(let f=0,E=i.length;f<E;f++){const L=u&&u[f],U=i[f];h&&L&&U.route.key===L.route.key?w[f]=h[f]:(m=!1,a[f]&&a[f](),Re(P=>{a[f]=P,w[f]=Me(t,w[f-1]||r,()=>l()[f+1],()=>s()[f])}))}return a.splice(i.length).forEach(f=>f()),h&&m?h:(c=w[0],w)}));return p(ne,{get when(){return l()&&c},children:i=>p(K.Provider,{value:i,get children(){return i.outlet()}})})},Xe=(e,t)=>()=>p(Ve,{base:t,children:e}),Qe=()=>{const e=z();return p(ne,{get when(){return e.child},children:t=>p(K.Provider,{value:t,get children(){return t.outlet()}})})};function Ye(e){const[,t]=Pe(e,["children","to","href","state"]),r=Ke(()=>e.to);return(()=>{const n=C(De);return be(n,t,!1,!0),S(n,()=>e.children),ee(o=>{const s=r()||e.href,a=JSON.stringify(e.state);return s!==o._v$&&X(n,"href",o._v$=s),a!==o._v$2&&X(n,"state",o._v$2=a),o},{_v$:void 0,_v$2:void 0}),$e(),n})()}function le(e){const t=Ge(()=>e.href);return p(Ye,ye(e,{get to(){return t()}}))}const Ze=A(`<a href="javascript:window.location.href='/micro-frontends-astro/react'">Go To React</a>`),et=A(`<a href="javascript:window.location.href='/micro-frontends-astro'">Go To Home</a>`),tt=A("<h1>Solid title</h1>"),nt=A("<div><h1>Root Page</h1><ul><li></li><li></li><li></li></ul></div>"),rt=A("<div><h1>Page 1</h1><ul><li></li><li></li><li></li></ul></div>"),ot="micro-frontends-astro",H=ot+"/solid",st=[{path:H,element:at},{path:H+"/page1",element:it}];function ue(){return C(Ze)}function he(){return C(et)}function lt(){const e=Xe(st);return p(Je,{get children(){return[C(tt),p(e,{})]}})}function at(){return(()=>{const e=C(nt),t=e.firstChild,r=t.nextSibling,n=r.firstChild,o=n.nextSibling,s=o.nextSibling;return S(n,p(le,{href:"page1",children:"Got to Page 1"})),S(o,p(ue,{})),S(s,p(he,{})),e})()}function it(){return(()=>{const e=C(rt),t=e.firstChild,r=t.nextSibling,n=r.firstChild,o=n.nextSibling,s=o.nextSibling;return S(n,p(le,{href:"/"+H,children:"Go To Root"})),S(o,p(ue,{})),S(s,p(he,{})),e})()}export{lt as default};
